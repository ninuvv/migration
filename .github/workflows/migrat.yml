name: Migrate Go package

on: [push]

jobs:
  migrate:

    runs-on: ubuntu-latest
    env:    
      GH_ACCESS_TOKEN: ${{secrets.SAGARWAL_PRIVREPOACCESSTOKEN_FOR_INVENTORY_MIGRATIONS_CICD_TESTING}}      
     
    steps:
        - uses: actions/checkout@v3
  
        - name: Set up Go
          uses: actions/setup-go@v4
          with:
            go-version: 1.18
 
        - name: Set up PostgreSQL client
          run: sudo apt-get install postgresql-client

        - name: Create Backup
          run: |
            export PGHOST=127.0.0.1
            export PGPORT=5432
            export PGUSER=onito_inv_user
            pg_dump -Fc Inventory > backup_file.dump
        
        
